<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Content Marketing | ANY EVER</title>
    <link rel="stylesheet" href="any-ever-brand.css">
    <style>
      /* Content Marketing Specific Styles - erweitert ANY EVER Brand CSS */
      
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        font-family: var(--font-primary);
        line-height: 1.6;
        color: var(--any-ever-black);
        background: var(--background-main);
        padding: 24px;
        font-weight: var(--font-weight-normal);
      }
      
      .container {
        max-width: 900px;
        margin: 0 auto;
        background: var(--background-content);
        box-shadow: var(--shadow-gold);
        border-radius: 16px;
        margin-bottom: 30px;
      }
      
      .header {
        background: var(--background-content);
        padding: 40px 40px 30px;
        text-align: center;
        position: relative;
        overflow: hidden;
        border-radius: 16px 16px 0 0;
        border-bottom: 2px solid var(--any-ever-gold);
      }
      
      .request-counter {
        position: absolute;
        top: 20px;
        left: 30px;
        font-size: 14px;
        color: var(--any-ever-light-grey);
        background: var(--any-ever-bright-grey);
        padding: 8px 16px;
        border-radius: 20px;
        border: 1px solid var(--border-light);
        z-index: 10;
        font-family: var(--font-primary);
        font-weight: var(--font-weight-medium);
      }
      
      .back-button {
        position: absolute;
        top: 20px;
        right: 30px;
        background: var(--any-ever-bright-grey);
        border: 1px solid var(--border-light);
        color: var(--any-ever-black);
        padding: 8px 16px;
        border-radius: 20px;
        text-decoration: none;
        font-size: 14px;
        font-weight: var(--font-weight-medium);
        transition: all 0.3s ease;
        z-index: 10;
        font-family: var(--font-primary);
      }
      
      .back-button:hover {
        background: var(--any-ever-stone-grey);
        border-color: var(--border-medium);
        transform: translateY(-1px);
      }
      
      .logo-container a {
        text-decoration: none;
      }
      
      .header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 200"><path d="M0,50 Q300,100 600,50 T1200,50 L1200,0 L0,0 Z" fill="rgba(250,250,250,1)"/></svg>') no-repeat;
        background-size: cover;
        z-index: 1;
      }
      
      .header-content {
        position: relative;
        z-index: 2;
      }
      
      .logo-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        margin-bottom: 20px;
      }
      
      .logo-anyever {
        width: 200px;
        height: auto;
        margin-bottom: 10px;
        opacity: 0.95;
      }
      
      .enjoy-audio {
        font-size: 14px;
        font-weight: var(--font-weight-medium);
        letter-spacing: var(--letter-spacing-medium);
        color: var(--any-ever-black);
        text-transform: uppercase;
        margin-top: 5px;
        font-family: var(--font-primary);
      }
      
      .header h1 {
        font-size: 32px;
        margin-bottom: 15px;
        font-weight: var(--font-weight-bold);
        text-transform: uppercase;
        letter-spacing: var(--letter-spacing-wide);
        color: var(--any-ever-black);
        font-family: var(--font-primary);
      }
      
      .form-content {
        padding: 40px;
        background: var(--background-content);
      }
      
      .section-title {
        font-size: 24px;
        color: var(--any-ever-black);
        margin-bottom: 25px;
        font-weight: var(--font-weight-bold);
        text-transform: uppercase;
        letter-spacing: var(--letter-spacing-wide);
        font-family: var(--font-primary);
      }
      
      .form-group {
        margin-bottom: 20px;
      }
      
      label {
        display: block;
        font-weight: var(--font-weight-medium);
        color: var(--any-ever-black);
        margin-bottom: 8px;
        font-size: 14px;
        text-transform: uppercase;
        letter-spacing: var(--letter-spacing-medium);
        font-family: var(--font-primary);
      }
      
      input[type="text"], 
      input[type="url"], 
      textarea {
        width: 100%;
        padding: 15px 20px;
        border: 2px solid var(--border-light);
        border-radius: 8px;
        font-size: 16px;
        background: var(--background-content);
        color: var(--any-ever-black);
        transition: all 0.3s ease;
        font-family: var(--font-primary);
        font-weight: var(--font-weight-normal);
      }
      
      input[type="text"]:focus, 
      input[type="url"]:focus, 
      textarea:focus {
        outline: none;
        border-color: var(--any-ever-gold);
        background: var(--any-ever-white);
        box-shadow: var(--focus-gold);
        transform: translateY(-2px);
      }
      
      textarea {
        min-height: 100px;
        resize: vertical;
      }
      
      .auto-resize {
        resize: vertical;
        overflow: hidden;
        min-height: 100px;
      }
      
      .status-message {
        transition: opacity 0.3s ease;
        padding: 15px 20px;
        border-radius: 8px;
        margin-bottom: 20px;
        font-weight: var(--font-weight-medium);
        text-align: center;
        font-family: var(--font-primary);
      }
      
      .loading-spinner {
        border: 2px solid var(--any-ever-bright-grey);
        border-top: 2px solid var(--any-ever-gold);
        border-radius: 50%;
        width: 20px;
        height: 20px;
        animation: spin 1s linear infinite;
        display: inline-block;
        margin-right: 8px;
      }
      
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      .rate-limit-timer {
        background: linear-gradient(135deg, #ef4444 0%, #f97316 100%);
        color: var(--any-ever-white);
        padding: 15px 20px;
        border-radius: 8px;
        font-weight: var(--font-weight-medium);
        text-align: center;
        margin-bottom: 20px;
        font-family: var(--font-primary);
      }
      
      .content-type-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
        margin-top: 20px;
      }
      
      .content-type-card {
        background: var(--background-content);
        border: 1px solid #f0f0f0;
        border-radius: 8px;
        padding: 15px;
        transition: all 0.3s ease;
        cursor: pointer;
        min-height: 90px;
        display: flex;
        align-items: center;
      }
      
      .content-type-card:hover {
        border-color: rgba(192, 174, 102, 0.3);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(192, 174, 102, 0.1);
      }
      
      .content-type-card.selected {
        border-color: var(--any-ever-gold);
        background: #fafafa;
        box-shadow: var(--focus-gold);
        transform: translateY(-1px);
      }

      .content-type-card.coming-soon {
        background: var(--background-content);
        border: 1px dashed #d1d5db;
        cursor: pointer;
        opacity: 0.7;
        position: relative;
      }

      .content-type-card.coming-soon:hover {
        border-color: rgba(192, 174, 102, 0.4);
        transform: translateY(-1px);
        box-shadow: 0 2px 8px rgba(192, 174, 102, 0.08);
        opacity: 0.8;
      }

      .content-type-card.coming-soon.selected {
        border: 1px dashed var(--any-ever-gold);
        background: #fafafa;
        box-shadow: 0 0 0 2px rgba(192, 174, 102, 0.1);
        transform: translateY(-1px);
        opacity: 0.8;
      }

      .content-type-card.coming-soon label {
        color: #6b7280;
      }

      .content-type-card.coming-soon .format-badge {
        background: #9ca3af;
        color: var(--any-ever-white);
      }

      .coming-soon-badge {
        display: inline-block;
        background: #9ca3af;
        color: var(--any-ever-white);
        padding: 3px 10px;
        border-radius: 10px;
        font-size: 10px;
        margin-top: 5px;
        font-weight: var(--font-weight-medium);
        font-family: var(--font-primary);
        letter-spacing: 0.3px;
        text-transform: uppercase;
        box-shadow: 0 2px 4px rgba(156, 163, 175, 0.2);
      }
      
      .content-type-card input[type="checkbox"] {
        width: 18px;
        height: 18px;
        margin-right: 12px;
        accent-color: var(--any-ever-gold);
        cursor: pointer;
      }
      
      .content-type-card label {
        margin: 0;
        color: var(--any-ever-black);
        font-size: 14px;
        text-transform: none;
        letter-spacing: normal;
        cursor: pointer;
        font-weight: var(--font-weight-medium);
        display: flex;
        align-items: center;
        font-family: var(--font-primary);
      }
      
      .format-badge {
        display: inline-block;
        background: var(--any-ever-gold);
        color: var(--any-ever-white);
        padding: 3px 10px;
        border-radius: 12px;
        font-size: 11px;
        margin-top: 8px;
        font-weight: var(--font-weight-medium);
        font-family: var(--font-primary);
        letter-spacing: 0.5px;
      }
      
      .submit-btn, .review-btn, .manual-btn {
        background: var(--gradient-gold);
        color: var(--any-ever-white);
        padding: 15px 40px;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: var(--font-weight-medium);
        text-transform: uppercase;
        letter-spacing: var(--letter-spacing-normal);
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: var(--shadow-gold);
        font-family: var(--font-primary);
      }
      
      .submit-btn:hover, .review-btn:hover, .manual-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 25px -5px rgba(192, 174, 102, 0.5);
        background: linear-gradient(135deg, #a58f4a 0%, var(--any-ever-gold) 100%);
      }
      
      .submit-btn:disabled, .review-btn:disabled, .manual-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }
      
      .review-container {
        display: none;
        opacity: 0;
        transform: translateY(-20px);
        transition: all 0.5s ease-in-out;
      }
      
      .review-container.show {
        display: block;
        opacity: 1;
        transform: translateY(0);
      }
      
      .review-section {
        padding: 40px;
        background: var(--background-content);
      }
      
      .content-section {
        background: var(--background-content);
        border: 1px solid var(--border-light);
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
        transition: all 0.3s ease;
      }
      
      .content-section:hover {
        border-color: rgba(192, 174, 102, 0.3);
        box-shadow: 0 2px 8px rgba(192, 174, 102, 0.1);
      }
      
      .content-section textarea {
        width: 100%;
        min-height: 120px;
        margin-bottom: 15px;
        padding: 15px;
        border: 2px solid var(--border-light);
        border-radius: 8px;
        font-family: var(--font-primary);
        font-size: 14px;
        resize: vertical;
        transition: border-color 0.3s ease;
      }
      
      .content-section textarea:focus {
        border-color: var(--any-ever-gold);
        outline: none;
        box-shadow: var(--focus-gold);
      }
      
      .content-section select {
        padding: 10px 15px;
        border: 2px solid var(--border-light);
        border-radius: 8px;
        font-family: var(--font-primary);
        font-size: 14px;
        background: var(--background-content);
        cursor: pointer;
        transition: border-color 0.3s ease;
        margin-bottom: 15px;
      }
      
      .content-section select:focus {
        border-color: var(--any-ever-gold);
        outline: none;
      }
      
      .post-action-buttons {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }
      
      .action-btn {
        padding: 8px 16px;
        border: none;
        border-radius: 6px;
        font-family: var(--font-primary);
        font-size: 12px;
        font-weight: var(--font-weight-medium);
        cursor: pointer;
        transition: all 0.3s ease;
        flex: 1;
        min-width: 120px;
      }
      
      .btn-post { 
        background: #10b981; 
        color: var(--any-ever-white); 
      }
      .btn-post:hover:not(:disabled) { 
        background: #059669; 
        transform: translateY(-1px);
      }
      
      .btn-schedule { 
        background: #3b82f6; 
        color: var(--any-ever-white); 
      }
      .btn-schedule:hover:not(:disabled) { 
        background: #2563eb; 
        transform: translateY(-1px);
      }
      
      .btn-draft { 
        background: var(--any-ever-light-grey); 
        color: var(--any-ever-white); 
      }
      .btn-draft:hover:not(:disabled) { 
        background: var(--any-ever-dark-grey); 
        transform: translateY(-1px);
      }
      
      .submit-section {
        text-align: right;
        margin-top: 30px;
        padding-top: 20px;
        border-top: 1px solid var(--border-light);
        display: flex;
        justify-content: flex-end;
        gap: 15px;
      }
      
      .anyever-footer {
        background: var(--any-ever-black);
        padding: 25px 40px;
        text-align: center;
        border-top: 2px solid var(--any-ever-gold);
        border-radius: 0 0 16px 16px;
        position: relative;
      }
      
      .anyever-footer .logo-footer {
        width: 100px;
        height: auto;
        margin-bottom: 8px;
      }
      
      .anyever-footer .tagline {
        color: var(--any-ever-stone-grey);
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: var(--letter-spacing-normal);
        font-family: var(--font-primary);
        font-weight: var(--font-weight-medium);
      }
      
     /* Styling f√ºr das Bilder-Auswahl-Grid */
.image-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr); /* Zeigt genau 2 Bilder pro Zeile an */
  gap: 15px;
}

      .image-option {
        border: 3px solid transparent;
        border-radius: 12px;
        cursor: pointer;
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
        box-shadow: 0 4px 6px rgba(0,0,0,0.05);
      }

      .image-option:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.1);
      }

      .image-option.selected {
        border-color: var(--any-ever-gold);
        box-shadow: 0 0 0 4px rgba(192, 174, 102, 0.3);
        transform: translateY(-2px);
      }

      .image-option img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
      }

      /* Visuelles Feedback f√ºr die Auswahl */
      .image-option .selected-overlay {
        display: none;
        position: absolute;
        top: 0; left: 0; right: 0; bottom: 0;
        background: rgba(192, 174, 102, 0.6);
        color: white;
        font-size: 36px;
        justify-content: center;
        align-items: center;
        backdrop-filter: blur(2px);
      }

      .image-option.selected .selected-overlay {
        display: flex;
      }

      @media (max-width: 768px) {
        body {
          padding: 12px;
        }
        
        .container {
          margin-bottom: 20px;
        }
        
        .header {
          padding: 30px 20px 20px;
        }
        
        .logo-anyever {
          width: 160px;
        }
        
        .header h1 {
          font-size: 24px;
        }
        
        .form-content, .review-section {
          padding: 30px 20px;
        }
        
        .request-counter {
          position: static;
          text-align: center;
          margin-bottom: 15px;
          display: block;
        }
        
        .content-type-grid {
          grid-template-columns: 1fr;
          gap: 12px;
        }
        
        .post-action-buttons {
          flex-direction: column;
        }
        
        .submit-section {
          text-align: center;
        }
        
        .submit-btn, .review-btn, .manual-btn {
          width: 100%;
          margin: 5px 0;
        }
      }
    </style>
  </head>
  <body>
    <div id="status-container"></div>

    <div id="rate-limit-container" style="display: none;">
      <div class="rate-limit-timer">
        <span>‚è±Ô∏è <strong>Rate Limit erreicht:</strong> Noch <span id="rate-limit-text"></span>
      </div>
    </div>

    <div class="container">
      <div class="header">
        <div class="request-counter">
          Requests heute: <span id="daily-request-count">0</span>/20
        </div>
        <a href="index.html" class="back-button">‚Üê ANY EVER Studio</a>
        <div class="header-content">
          <div class="logo-container">
            <a href="index.html">
              <img src="https://anyever.de/wp-content/themes/anyever/static/images/logo-anyever-gold.svg" alt="Any Ever Logo" class="logo-anyever" />
            </a>
            <div class="enjoy-audio">ENJOY.AUDIO</div>
          </div>
          <h1>Content Marketing</h1>
        </div>
      </div>

      <div class="form-content">
        <div class="form-group">
          <label for="thema">Thema (Pflichtfeld)</label>
          <textarea id="thema" class="auto-resize" placeholder="Beschreiben Sie Ihr Thema" required rows="2" oninput="autoResize(this)"></textarea>
        </div>

        <div class="form-group">
          <label for="subline">Subline (optional)</label>
          <textarea id="subline" class="auto-resize" placeholder="Zus√§tzliche Informationen oder Untertitel" rows="2" oninput="autoResize(this)"></textarea>
        </div>

        <div class="form-group">
          <label for="input_image_idea">Bildidee (optional)</label>
          <textarea id="input_image_idea" class="auto-resize" placeholder="Beschreiben Sie Ihre Bildvorstellung f√ºr die Social Media Posts" rows="2" oninput="autoResize(this)"></textarea>
        </div>

        <div class="form-group">
          <label>Content-Kan√§le ausw√§hlen (mindestens einen)</label>
          
          <div style="margin-top: 25px; margin-bottom: 20px;">
            <h3 style="font-size: 16px; font-weight: var(--font-weight-medium); color: var(--any-ever-black); margin-bottom: 15px; text-transform: uppercase; letter-spacing: var(--letter-spacing-medium); font-family: var(--font-primary);">Business Content</h3>
            <div class="content-type-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
              <div class="content-type-card" id="card-newsletter">
                <label>
                  <input type="checkbox" id="enable_newsletter" class="content-checkbox" />
                  <div>
                    <div style="font-weight: 600;">Newsletter</div>
                    <div style="font-size: 12px; color: #6b7280;">E-Mail Marketing</div>
                    <span class="format-badge">E-Mail</span>
                  </div>
                </label>
              </div>

              <div class="content-type-card" id="card-blog">
                <label>
                  <input type="checkbox" id="enable_blog" class="content-checkbox" />
                  <div>
                    <div style="font-weight: 600;">Blog Artikel</div>
                    <div style="font-size: 12px; color: #6b7280;">Langform Content</div>
                    <span class="format-badge">16:9</span>
                  </div>
                </label>
              </div>
            </div>
          </div>

          <div style="margin-bottom: 20px;">
            <h3 style="font-size: 16px; font-weight: var(--font-weight-medium); color: var(--any-ever-black); margin-bottom: 15px; text-transform: uppercase; letter-spacing: var(--letter-spacing-medium); font-family: var(--font-primary);">Social Media</h3>
            
            <div class="content-type-grid" style="grid-template-columns: repeat(2, 1fr); margin-bottom: 15px;">
              <div class="content-type-card" id="card-linkedin">
                <label>
                  <input type="checkbox" id="enable_linkedin" class="content-checkbox" />
                  <div>
                    <div style="font-weight: 600;">LinkedIn Post</div>
                    <div style="font-size: 12px; color: #6b7280;">Business Content</div>
                    <span class="format-badge">1:1</span>
                  </div>
                </label>
              </div>

              <div class="content-type-card" id="card-facebook">
                <label>
                  <input type="checkbox" id="enable_facebook" class="content-checkbox" />
                  <div>
                    <div style="font-weight: 600;">Facebook Post</div>
                    <div style="font-size: 12px; color: #6b7280;">Social Media</div>
                    <span class="format-badge">1:1</span>
                  </div>
                </label>
              </div>
            </div>

            <div class="content-type-grid" style="grid-template-columns: repeat(3, 1fr);">
              <div class="content-type-card" id="card-instagram_feed">
                <label>
                  <input type="checkbox" id="enable_instagram_feed" class="content-checkbox" />
                  <div>
                    <div style="font-weight: 600;">Instagram Feed</div>
                    <div style="font-size: 12px; color: #6b7280;">Quadratisch</div>
                    <span class="format-badge">1:1</span>
                  </div>
                </label>
              </div>

              <div class="content-type-card" id="card-instagram_story">
                <label>
                  <input type="checkbox" id="enable_instagram_story" class="content-checkbox" />
                  <div>
                    <div style="font-weight: 600;">Instagram Story</div>
                    <div style="font-size: 12px; color: #6b7280;">Hochformat</div>
                    <span class="format-badge">9:16</span>
                    </div>
                </label>
              </div>

              <div class="content-type-card" id="card-instagram_reel">
                <label>
                  <input type="checkbox" id="enable_instagram_reel" class="content-checkbox" />
                  <div>
                    <div style="font-weight: 600;">Instagram Reel</div>
                    <div style="font-size: 12px; color: #6b7280;">Video Content</div>
                    <span class="format-badge">9:16 Video</span>                   
                  </div>
                </label>
              </div>
            </div>
          </div>

          <div style="margin-bottom: 20px;">
            <h3 style="font-size: 16px; font-weight: var(--font-weight-medium); color: var(--any-ever-black); margin-bottom: 15px; text-transform: uppercase; letter-spacing: var(--letter-spacing-medium); font-family: var(--font-primary);">Sonderformate</h3>
            <div class="content-type-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
              <div class="content-type-card" id="card-podcast">
                <label>
                  <input type="checkbox" id="enable_podcast" class="content-checkbox" />
                  <div>
                    <div style="font-weight: 600;">Audio-Podcast</div>
                    <div style="font-size: 12px; color: #6b7280;">Audio Content</div>
                    <span class="format-badge">Text-to-Speech</span>
                  </div>
                </label>
              </div>

              <div class="content-type-card" id="card-avatar">
                <label>
                  <input type="checkbox" id="enable_avatar" class="content-checkbox" />
                  <div>
                    <div style="font-weight: 600;">Avatar Video</div>
                    <div style="font-size: 12px; color: #6b7280;">AI Video</div>
                    <span class="format-badge">Video Avatar</span>                    
                  </div>
                </label>
              </div>
            </div>
          </div>
        </div>

        <div class="submit-section">
          <button id="submit-btn" onclick="submitForm()" class="submit-btn">
            Inhalt √ºbermitteln
          </button>
        </div>
      </div>
    </div>

    <div class="container review-container" id="review-container">
      <div class="header">
        <div class="header-content">
          <h1 style="font-size: 28px;">Content Review & Ver√∂ffentlichung</h1>
        </div>
      </div>

      <div class="review-section" style="padding: 40px;">
        <div id="image-selection-container" style="display: none; margin-bottom: 40px;">
          <h3 style="font-size: 18px; font-weight: 600; color: #1f2937; margin-bottom: 15px;">
            Bildauswahl f√ºr Social Media (1:1 Format)
          </h3>
          <p style="font-size: 14px; color: #6b7280; margin-bottom: 20px;">
            W√§hlen Sie ein Bild aus. Es wird f√ºr LinkedIn, Facebook und den Instagram Feed verwendet.
          </p>
          <div id="image-selection-grid" class="image-grid">
            </div>
          <input type="hidden" id="selected_image_url" name="selected_image_url">
        </div>
        <input type="text" id="input_id" style="position: absolute; left: -9999px; opacity: 0;" readonly /><input type="text" id="input_id" style="position: absolute; left: -9999px; opacity: 0;" readonly />

        <div id="content-sections-container"></div>

        <div class="submit-section">
          <button id="manual-load-btn" onclick="loadReview(false)" class="manual-btn" style="display: none;">
            üîÑ Content aktualisieren
          </button>
          <button id="review-submit-btn" onclick="submitReview()" class="review-btn" style="display: none;">
            Freigaben speichern
          </button>
        </div>
      </div>
      
      <div class="anyever-footer">
        <img 
          src="https://anyever.de/wp-content/themes/anyever/static/images/logo-anyever-gold.svg" 
          alt="ANY EVER Logo" 
          class="logo-footer"
        >
        <div class="tagline">ENJOY.AUDIO</div>
        
        <div id="dynamic-timestamp" style="position: absolute; bottom: 8px; right: 12px; font-size: 10px; color: rgba(192, 174, 102, 0.6); font-family: 'Courier New', monospace; letter-spacing: 0.5px;">
          </div>
      </div>
    </div>

    <script>
      // Global Variables & Rate Limiting
      const inputId = Date.now().toString();
      let isPolling = false;
      let rateLimitTimer = null;

      // === CHANNEL CONFIG ===
      // Hier einfach true/false √§ndern um Kan√§le zu aktivieren/deaktivieren
      const CHANNEL_CONFIG = {
        linkedin: true,
        facebook: true,
        instagram_feed: true,
        instagram_story: false,    
        instagram_reel: false,    
        newsletter: false,
        blog: false,
        podcast: true,
        avatar: false,            
      };
      // === ENDE CONFIG ===
      
      const RATE_LIMITS = {
        DAILY_MAX: 20,
        COOLDOWN_MINUTES: 5,
        STORAGE_KEY: 'content_generation_rate_limit'
      };

      // Updated Content Type Configuration
      const CONTENT_TYPES = {
        linkedin: { 
          id: 'linkedin', 
          label: 'LinkedIn Post', 
          textField: 'linkedin_text', 
          statusField: 'linkedin_status',
          enableField: 'enable_linkedin',
          backendTextKey: 'linkedin_text',      
          backendStatusKey: 'linkedin_status',
          postingEnabled: true,
          imageFormat: '1:1'
        },
        facebook: { 
          id: 'facebook', 
          label: 'Facebook Post', 
          textField: 'facebook_text', 
          statusField: 'facebook_status',
          enableField: 'enable_facebook',
          backendTextKey: 'facebook_text',      
          backendStatusKey: 'facebook_status',
          postingEnabled: true,
          imageFormat: '1:1'
        },
        instagram_feed: { 
          id: 'instagram_feed', 
          label: 'Instagram Feed', 
          textField: 'instagram_feed_text', 
          statusField: 'instagram_feed_status',
          enableField: 'enable_instagram_feed',
          backendTextKey: 'insta_feed_text',    
          backendStatusKey: 'insta_feed_status',
          postingEnabled: false,
          imageFormat: '1:1'
        },
        instagram_reel: { 
          id: 'instagram_reel', 
          label: 'Instagram Reel', 
          textField: 'instagram_reel_text', 
          statusField: 'instagram_reel_status',
          enableField: 'enable_instagram_reel',
          backendTextKey: 'insta_reel_text',    
          backendStatusKey: 'insta_reel_status',
          postingEnabled: false,
          imageFormat: '9:16 Video'
        },
        instagram_story: { 
          id: 'instagram_story', 
          label: 'Instagram Story', 
          textField: 'instagram_story_text', 
          statusField: 'instagram_story_status',
          enableField: 'enable_instagram_story',
          backendTextKey: 'insta_story_text',    
          backendStatusKey: 'insta_story_status',
          postingEnabled: false,
          imageFormat: '9:16'
        },
        blog: { 
          id: 'blog', 
          label: 'Blog Artikel', 
          textField: 'blog_text', 
          statusField: 'blog_status',
          enableField: 'enable_blog',
          backendTextKey: 'blog_text',          
          backendStatusKey: 'blog_status',
          postingEnabled: false,
          imageFormat: '16:9'
        },
        podcast: {
          id: 'podcast',
          label: 'Podcast Skript',
          textField: 'podcast_text',
          statusField: 'podcast_status', 
          enableField: 'enable_podcast',
          backendTextKey: 'podcast_text',       
          backendStatusKey: 'podcast_status',
          postingEnabled: true,
          imageFormat: 'Text-to-Speech'
        },
        avatar: {
          id: 'avatar',
          label: 'Avatar Skript',
          textField: 'avatar_text',
          statusField: 'avatar_status',
          enableField: 'enable_avatar', 
          backendTextKey: 'avatar_text',        
          backendStatusKey: 'avatar_status',
          postingEnabled: false,
          imageFormat: 'Video Avatar'
        },
        newsletter: {
          id: 'newsletter',
          label: 'Newsletter',
          textField: 'newsletter_text',
          statusField: 'newsletter_status',
          enableField: 'enable_newsletter', 
          backendTextKey: 'newsletter_text',        
          backendStatusKey: 'newsletter_status',
          postingEnabled: true,
          imageFormat: 'E-Mail'
        }
      };

      // Function to format the timestamp and update the footer
      function updateTimestamp() {
        const pad = (num) => num.toString().padStart(2, '0');
        const now = new Date();
        const day = pad(now.getDate());
        const month = pad(now.getMonth() + 1);
        const year = now.getFullYear();
        const hours = pad(now.getHours());
        const minutes = pad(now.getMinutes());
        const seconds = pad(now.getSeconds());
        const timestampString = `Stand: ${day}.${month}.${year} ${hours}:${minutes}:${seconds}`;
        
        const timestampContainer = document.getElementById('dynamic-timestamp');
        if (timestampContainer) {
            timestampContainer.textContent = timestampString;
        }
      }

      // Initialize
      document.addEventListener("DOMContentLoaded", () => {
        console.log('üöÄ DYNAMIC TIMESTAMP ENABLED');
        updateTimestamp(); // Set timestamp on initial load
        
        document.getElementById("input_id").value = inputId;
        
        // Apply Channel Config
        Object.keys(CHANNEL_CONFIG).forEach(channel => {
          const checkbox = document.getElementById(`enable_${channel}`);
          const card = document.getElementById(`card-${channel}`);
          
          if (checkbox && card) {
            checkbox.checked = CHANNEL_CONFIG[channel];
            
            if (CHANNEL_CONFIG[channel]) {
              card.classList.add('selected');
            } else {
              card.style.opacity = '0.5';
              card.style.pointerEvents = 'none';
            }
          }
        });
        
        updateRequestCounter();
        
        document.querySelectorAll('.content-checkbox').forEach(checkbox => {
          checkbox.addEventListener('change', function() {
            const card = this.closest('.content-type-card');
            card.classList.toggle('selected', this.checked);
          });
        });
      });

      // Rate Limiting Functions
      function getRateLimitData() {
        const stored = localStorage.getItem(RATE_LIMITS.STORAGE_KEY);
        if (!stored) return { requests: 0, lastReset: new Date().toDateString(), lastRequest: null };
        return JSON.parse(stored);
      }

      function updateRateLimit() {
        const data = getRateLimitData();
        const today = new Date().toDateString();
        
        if (data.lastReset !== today) {
          data.requests = 0;
          data.lastReset = today;
        }
        
        data.requests++;
        data.lastRequest = Date.now();
        
        localStorage.setItem(RATE_LIMITS.STORAGE_KEY, JSON.stringify(data));
        updateRequestCounter();
        
        if (data.requests >= RATE_LIMITS.DAILY_MAX) {
          showRateLimitBanner();
        }
      }

      function checkRateLimit() {
        const data = getRateLimitData();
        const today = new Date().toDateString();
        
        if (data.lastReset !== today) return true;
        
        if (data.requests >= RATE_LIMITS.DAILY_MAX) {
          if (data.lastRequest) {
            const cooldownEnd = data.lastRequest + (RATE_LIMITS.COOLDOWN_MINUTES * 60 * 1000);
            const now = Date.now();
            
            if (now < cooldownEnd) {
              const remaining = Math.ceil((cooldownEnd - now) / 60000);
              showErrorMessage(`Rate Limit erreicht. Versuchen Sie es in ${remaining} Minuten erneut.`);
              return false;
            } else {
              data.requests = 0;
              localStorage.setItem(RATE_LIMITS.STORAGE_KEY, JSON.stringify(data));
              updateRequestCounter();
              hideRateLimitBanner();
            }
          }
        }
        
        return true;
      }

      function updateRequestCounter() {
        const data = getRateLimitData();
        const today = new Date().toDateString();
        const requests = data.lastReset === today ? data.requests : 0;
        document.getElementById("daily-request-count").textContent = requests;
      }

      function showRateLimitBanner() {
        const banner = document.getElementById("rate-limit-container");
        const data = getRateLimitData();
        
        if (data.lastRequest) {
          const cooldownEnd = data.lastRequest + (RATE_LIMITS.COOLDOWN_MINUTES * 60 * 1000);
          const now = Date.now();
          
          if (now < cooldownEnd) {
            const remaining = Math.ceil((cooldownEnd - now) / 60000);
            document.getElementById("rate-limit-text").textContent = `${remaining} Minuten`;
            banner.style.display = "block";
            
            rateLimitTimer = setInterval(() => {
              const newRemaining = Math.ceil((cooldownEnd - Date.now()) / 60000);
              if (newRemaining <= 0) {
                hideRateLimitBanner();
              } else {
                document.getElementById("rate-limit-text").textContent = `${newRemaining} Minuten`;
              }
            }, 60000);
          }
        }
      }

      function hideRateLimitBanner() {
        document.getElementById("rate-limit-container").style.display = "none";
        if (rateLimitTimer) {
          clearInterval(rateLimitTimer);
          rateLimitTimer = null;
        }
      }

      // Base64 Utilities
      function encodeToBase64(text) {
        try {
          const encoder = new TextEncoder();
          const bytes = encoder.encode(text);
          const binaryString = Array.from(bytes, byte => String.fromCharCode(byte)).join('');
          return btoa(binaryString);
        } catch (error) {
          console.error("‚ùå Base64 Encoding Fehler:", error);
          return text;
        }
      }

      function decodeBase64Text(base64String) {
        try {
          if (!base64String || base64String.trim() === '') return '';
          const binaryString = atob(base64String);
          const bytes = new Uint8Array(binaryString.length);
          for (let i = 0; i < binaryString.length; i++) {
            bytes[i] = binaryString.charCodeAt(i);
          }
          return new TextDecoder('utf-8').decode(bytes);
        } catch (error) {
          console.error("‚ùå Base64 Decode Fehler:", error);
          try {
            return atob(base64String);
          } catch (fallbackError) {
            return base64String;
          }
        }
      }

      function autoResize(textarea) {
        textarea.style.height = 'auto';
        textarea.style.height = Math.max(100, textarea.scrollHeight) + 'px';
      }

      // Enhanced Validation & Submission
      async function submitForm() {
        if (!checkRateLimit()) {
          return;
        }
        
        const thema = document.getElementById("thema").value.trim();
        if (!thema) {
          showErrorMessage("Bitte f√ºllen Sie das Thema-Feld aus.");
          return;
        }

        const selectedChannels = getSelectedChannels();
        if (selectedChannels.length === 0) {
          showErrorMessage("Bitte w√§hlen Sie mindestens einen Content-Kanal aus.");
          return;
        }

        const channelNames = selectedChannels.map(ch => CONTENT_TYPES[ch].label).join(', ');
        if (!confirm(`Content wird generiert f√ºr: ${channelNames}. Fortfahren?`)) return;

        const payload = {
          input_id: inputId,
          thema: thema,
          subline: document.getElementById("subline").value,
          input_image_idea: document.getElementById("input_image_idea").value,
          selected_channels: selectedChannels
        };

        await executeSubmission(payload);
      }

      function getSelectedChannels() {
        return Object.keys(CONTENT_TYPES).filter(type => 
          document.getElementById(CONTENT_TYPES[type].enableField).checked
        );
      }

      async function executeSubmission(payload) {
        const webhookUrl = "https://hook.eu2.make.com/cv9u4q1t3exjr6wz196owrm4ud6atahl";

        try {
          showLoadingState(true);
          showProgressMessage("Content wird generiert...");
          
          const response = await fetch(webhookUrl, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload),
          });

          if (response.ok) {
            updateRateLimit();
            showSuccessMessage("Erfolgreich gestartet! ‚úÖ");
            
            // Show review container with animation
            const reviewContainer = document.getElementById('review-container');
            if (reviewContainer) {
              reviewContainer.classList.add('show');
            }
            
            createContentSections(payload.selected_channels);
            showInfoMessage("‚è±Ô∏è Generation l√§uft ca. 2-3 Minuten...", true);
            
            setTimeout(async () => {
              await startIntelligentPolling();
            }, 30000);
            
          } else {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }
        } catch (error) {
          console.error("Submission error:", error);
          showErrorMessage(`Fehler beim √úbertragen: ${error.message}`);
        } finally {
          showLoadingState(false);
        }
      }

      // Dynamic Content Sections with Posting Actions - KOMPLETT KORRIGIERT
      function createContentSections(selectedChannels) {
        const container = document.getElementById("content-sections-container");
        container.innerHTML = "";
        
        selectedChannels.forEach(channel => {
          const config = CONTENT_TYPES[channel];
          const sectionDiv = document.createElement('div');
          sectionDiv.id = `${channel}-section`;
          sectionDiv.className = 'content-section';
          
          const postingButtons = config.postingEnabled ?
            `
            <div class="post-action-buttons">
              <button class="action-btn btn-post" onclick="postContent('${channel}')" disabled>
                üöÄ Sofort posten
              </button>
              <button class="action-btn btn-schedule" onclick="scheduleContent('${channel}')" disabled>
                üìÖ Planen
              </button>
              <button class="action-btn btn-draft" onclick="saveDraft('${channel}')" disabled>
                üìù Als Entwurf
              </button>
            </div>
          ` : `
            <div style="font-size: 14px; color: #6b7280; margin-top: 10px;">
              Automatisches Posting f√ºr diesen Kanal noch nicht verf√ºgbar
            </div>
          `;
          
          sectionDiv.innerHTML = `
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
              <label style="font-size: 18px; font-weight: 600; color: #1f2937; margin: 0;">${config.label}:</label>
              <div style="display: flex; align-items: center; gap: 10px; margin-left: auto;">
                <span style="font-size: 12px; color: #6b7280;">${config.imageFormat}</span>
                <span class="status-badge" style="background: #dbeafe; color: #1e40af;">Wird generiert...</span>
              </div>
            </div>
            <textarea id="${config.textField}" class="auto-resize" 
                      placeholder="${config.label} Content wird generiert..."
                      oninput="autoResize(this); updatePostingButtons('${channel}')"></textarea>
            <select id="${config.statusField}" onchange="updatePostingButtons('${channel}')">
              <option value="pending">Auswahl treffen</option>
              <option value="yes">Freigeben</option>
              <option value="no">Ablehnen</option>
            </select>
            ${postingButtons}
          `;
          
          container.appendChild(sectionDiv);
        });
      }

      function updatePostingButtons(channel) {
        const config = CONTENT_TYPES[channel];
        const statusField = document.getElementById(config.statusField);
        const textField = document.getElementById(config.textField);
        const section = document.getElementById(`${channel}-section`);
        
        if (!section || !config.postingEnabled) return;
        
        const buttons = section.querySelectorAll('.action-btn');
        const isApproved = statusField.value === 'yes';
        const hasContent = textField.value.trim() !== '';
        
        buttons.forEach(btn => {
          btn.disabled = !(isApproved && hasContent);
        });
      }

      // Polling System
      async function startIntelligentPolling() {
        let attempts = 0;
        const maxAttempts = 24;
        
        console.log("üöÄ === POLLING GESTARTET ===");
        
        const poll = async () => {
          attempts++;
          console.log(`\nüîÑ === POLLING VERSUCH ${attempts}/${maxAttempts} ===`);
          
          showInfoMessage(`üîÑ Pr√ºfe Content... (${attempts}/${maxAttempts})`, true);
          
          try {
            const success = await loadReview(true);
            
            if (success) {
              console.log("‚úÖ === POLLING ERFOLGREICH BEENDET ===");
              clearPersistentMessage();
              showSuccessMessage("‚úÖ Content ist da! Automatisch geladen.");
              return;
            }
            
            if (attempts < maxAttempts) {
              setTimeout(() => poll(), 15000);
            } else {
              clearPersistentMessage();
              showWarningMessage("‚è±Ô∏è Automatische Suche beendet. Nutzen Sie den 'Content aktualisieren' Button.");
              document.getElementById("manual-load-btn").style.display = "inline-block";
            }
          } catch (error) {
            console.error(`‚ùå POLLING FEHLER:`, error);
            if (attempts < maxAttempts) {
              setTimeout(() => poll(), 15000);
            } else {
              clearPersistentMessage();
              showErrorMessage("‚ùå Fehler beim automatischen Laden.");
              document.getElementById("manual-load-btn").style.display = "inline-block";
            }
          }
        };
        
        poll();
      }

      async function loadReview(silentMode = false) {
        const inputIdValue = document.getElementById("input_id").value;
        if (!inputIdValue) {
          if (!silentMode) showErrorMessage("Keine Input-ID vorhanden.");
          return false;
        }

        // NEU: Bilder-Grid zur√ºcksetzen
        const imageContainer = document.getElementById("image-selection-container");
        if (imageContainer) imageContainer.style.display = "none";
        const imageGrid = document.getElementById("image-selection-grid");
        if (imageGrid) imageGrid.innerHTML = "";

        const webhookUrl = `https://hook.eu2.make.com/hw1siz7ad14nfv7tr4y0cte3l2rtkwxm?mode=load&input_id=${inputIdValue}`;

        try {
          if (!silentMode) showProgressMessage("Lade Content...");
          
          console.log("üîç === DEBUGGING loadReview ===");
          console.log("Input ID:", inputIdValue);
          console.log("Webhook URL:", webhookUrl);
          
          const response = await fetch(webhookUrl);
          if (!response.ok) throw new Error(`HTTP ${response.status}: ${response.statusText}`);

          const responseText = await response.text();
          console.log("üì• Raw Response:", responseText);
          
          let data;
          try {
            data = JSON.parse(responseText);
            console.log("üìä Parsed Data:", data);
          } catch (parseError) {
            console.error("‚ùå JSON Parse Error:", parseError);
            console.log("üîß Attempting to fix JSON...");
            
            // Versuche JSON zu reparieren
            let fixedJson = responseText;
            
            // H√§ufige JSON-Fehler beheben
            fixedJson = fixedJson.replace(/,(\s*[}\]])/g, '$1'); // Entferne trailing commas
            fixedJson = fixedJson.replace(/([{,]\s*)(\w+):/g, '$1"$2":'); // F√ºge Anf√ºhrungszeichen um Keys hinzu
            fixedJson = fixedJson.replace(/:\s*'([^']*)'/g, ':"$1"'); // Ersetze single quotes mit double quotes
            fixedJson = fixedJson.replace(/\\n/g, '\\\\n'); // Escape newlines properly
            fixedJson = fixedJson.replace(/\\"/g, '\\\\"'); // Escape quotes properly
            
            try {
              data = JSON.parse(fixedJson);
              console.log("‚úÖ JSON repariert:", data);
            } catch (secondError) {
              console.error("‚ùå JSON konnte nicht repariert werden:", secondError);
              
              // Fallback: Versuche Daten manuell zu extrahieren
              const extractData = {};
              Object.keys(CONTENT_TYPES).forEach(type => {
                const config = CONTENT_TYPES[type];
                
                // Suche nach den Datenfeldern im Raw-Text
                const textMatch = responseText.match(new RegExp(`"${config.backendTextKey}"\\s*:\\s*"([^"]*)"`, 'i'));
                const statusMatch = responseText.match(new RegExp(`"${config.backendStatusKey}"\\s*:\\s*"([^"]*)"`, 'i'));
                
                if (textMatch) {
                  extractData[config.backendTextKey] = textMatch[1];
                }
                if (statusMatch) {
                  extractData[config.backendStatusKey] = statusMatch[1];
                }
              });
              
              if (Object.keys(extractData).length > 0) {
                data = extractData;
                console.log("üîß Daten manuell extrahiert:", data);
              } else {
                if (!silentMode) showErrorMessage(`JSON-Fehler beim Laden des Contents.`);
                return false;
              }
            }
          }
          
          let hasGeneratedContent = false;
          let sectionsWithContent = 0;
          let totalSections = 0;
          
          Object.keys(CONTENT_TYPES).forEach(type => {
            const config = CONTENT_TYPES[type];
            const sectionElement = document.getElementById(`${type}-section`);
            
            console.log(`üîç Checking ${type}:`, {
              sectionExists: !!sectionElement,
              backendTextKey: config.backendTextKey,
              backendData: data[config.backendTextKey]
            });
            
            if (sectionElement) {
              totalSections++;
              
              let backendText = data[config.backendTextKey];
              const backendStatus = data[config.backendStatusKey];
              
              console.log(`üìù ${type} Raw Text:`, backendText);
              
              if (backendText) {
                backendText = decodeBase64Text(backendText);
                console.log(`üìù ${type} Decoded Text:`, backendText);
              }
              
              const hasContent = backendText && backendText.trim() !== '';
              
              if (hasContent) {
                sectionsWithContent++;
                hasGeneratedContent = true;
                
                const textField = document.getElementById(config.textField);
                const statusField = document.getElementById(config.statusField);
                
                console.log(`‚úÖ ${type} Content found:`, {
                  textField: !!textField,
                  statusField: !!statusField,
                  content: backendText.substring(0, 100) + "..."
                });
                
               if (textField) {
    // Loggt den rohen Text, wie er vom Server kommt, in die Konsole
    console.log("===== START ROHDATEN F√úR KANAL: " + type + " =====");
    console.log(backendText);
    console.log("===== ENDE ROHDATEN =====");

    // Der alte Code wird vor√ºbergehend auskommentiert
    // let finalText = backendText || "";
    // finalText = finalText.replace(/\\n/g, '\n');
    // textField.value = finalText;

    // Wir setzen den Wert erstmal direkt, um zu sehen, was passiert
    textField.value = backendText || "";
    autoResize(textField);
}
                
                if (statusField) statusField.value = backendStatus || "pending";
                
                updateSectionStatus(sectionElement, backendStatus);
                updatePostingButtons(type);
              } else {
                console.log(`‚ö†Ô∏è ${type} No content found`);
              }
            } else {
              console.log(`‚ùå ${type} Section element not found!`);
            }
          });
          
          console.log("üìä Final Stats:", {
            totalSections,
            sectionsWithContent,
            hasGeneratedContent,
            allSectionsFilled: totalSections > 0 && sectionsWithContent === totalSections
          });
          
          const allSectionsFilled = totalSections > 0 && sectionsWithContent === totalSections;
          
          // NEU: Bilder-Grid bef√ºllen, wenn Bild-URLs vorhanden sind
          const imageUrls = [
            data.image_option_1_url,
            data.image_option_2_url,
            data.image_option_3_url,
            data.image_option_4_url
          ].filter(url => url && url.startsWith('http')); // Nur g√ºltige URLs nehmen

          if (imageUrls.length > 0) {
            populateImageGrid(imageUrls, data.selected_image_url);
          }

          document.getElementById("review-submit-btn").style.display = hasGeneratedContent ? "block" : "none";
          
          if (allSectionsFilled) {
            clearPersistentMessage();
            if (!silentMode) showSuccessMessage("‚úÖ Content erfolgreich geladen!");
            return true;
          } else {
            if (!silentMode) {
              showWarningMessage(`‚ö†Ô∏è Content wird noch generiert... (${sectionsWithContent}/${totalSections} Kan√§le fertig)`);
            }
            return false;
          }
          
        } catch (error) {
          console.error("‚ùå Fehler beim Laden der Review-Daten", error);
          if (!silentMode) showErrorMessage(`Fehler beim Laden des Contents: ${error.message}`);
          return false;
        }
      }

      function updateSectionStatus(sectionDiv, status) {
        const statusBadge = sectionDiv.querySelector('.status-badge');
        if (statusBadge) {
          const statusConfig = {
            'pending': { text: 'Pending', class: 'background: #fef3c7; color: #92400e;' },
            'yes': { text: 'Freigegeben', class: 'background: #d1fae5; color: #065f46;' },
            'no': { text: 'Abgelehnt', class: 'background: #fee2e2; color: #991b1b;' },
            'posted': { text: 'Ver√∂ffentlicht', class: 'background: #e0e7ff; color: #3730a3;' }
          };
          
          const config = statusConfig[status] || statusConfig['pending'];
          statusBadge.textContent = config.text;
          statusBadge.setAttribute('style', `padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; ${config.class}`);
        }
      }

      function populateImageGrid(urls, selectedUrl) {
        const container = document.getElementById("image-selection-container");
        const grid = document.getElementById("image-selection-grid");
        const hiddenInput = document.getElementById("selected_image_url");
        
        if (!grid || !container || !hiddenInput) return;
        
        grid.innerHTML = ""; // Altes Grid leeren
        
        urls.forEach((url, index) => {
          const isSelected = url === selectedUrl;
        
          const optionDiv = document.createElement('div');
          optionDiv.className = 'image-option';
          if (isSelected) {
            optionDiv.classList.add('selected');
          }
          optionDiv.setAttribute('onclick', `selectImage(this, '${url}')`);
          
          optionDiv.innerHTML = `
            <img src="${url}" alt="Bildvariante ${index + 1}">
            <div class="selected-overlay">‚úî</div>
          `;
          
          grid.appendChild(optionDiv);
        });
        
        hiddenInput.value = selectedUrl || "";
        container.style.display = "block"; // Grid anzeigen
      }

      function selectImage(element, imageUrl) {
        // Alle 'selected' Klassen entfernen
        const allOptions = document.querySelectorAll('.image-option');
        allOptions.forEach(opt => opt.classList.remove('selected'));
        
        // Klasse zum angeklickten Element hinzuf√ºgen
        element.classList.add('selected');
        
        // URL im versteckten Feld speichern
        document.getElementById('selected_image_url').value = imageUrl;
        console.log('üñºÔ∏è Bild ausgew√§hlt:', imageUrl);
      }

      // Posting Functions
      async function postContent(channel) {
        const config = CONTENT_TYPES[channel];
        const content = document.getElementById(config.textField).value;
        const inputIdValue = document.getElementById("input_id").value;
        
        if (!confirm(`${config.label} sofort ver√∂ffentlichen?`)) return;
        
        try {
          showProgressMessage(`Ver√∂ffentliche ${config.label}...`);
          
          const webhookUrl = "https://hook.eu2.make.com/hw1siz7ad14nfv7tr4y0cte3l2rtkwxm";
          const response = await fetch(webhookUrl, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              input_id: inputIdValue,
              mode: "post",
              channel: channel,
              content: escapeJsonString(content),
              action: "immediate"
            }),
          });
          
          if (response.ok) {
            showSuccessMessage(`‚úÖ ${config.label} erfolgreich ver√∂ffentlicht!`);
            updateSectionStatus(document.getElementById(`${channel}-section`), 'posted');
          } else {
            throw new Error(`HTTP ${response.status}`);
          }
        } catch (error) {
          showErrorMessage(`Fehler beim Ver√∂ffentlichen: ${error.message}`);
        }
      }

      async function scheduleContent(channel) {
        const config = CONTENT_TYPES[channel];
        const scheduleTime = prompt("Wann soll gepostet werden? (Format: YYYY-MM-DD HH:MM)");
        
        if (!scheduleTime) return;
        
        showInfoMessage(`‚è∞ ${config.label} f√ºr ${scheduleTime} geplant (Feature in Entwicklung)`);
      }

      async function saveDraft(channel) {
        const config = CONTENT_TYPES[channel];
        showInfoMessage(`üìù ${config.label} als Entwurf gespeichert (Feature in Entwicklung)`);
      }

      async function submitReview() {
        const payload = {
          input_id: document.getElementById("input_id").value,
          mode: "save",
          selected_image_url: document.getElementById("selected_image_url").value
        };

        Object.keys(CONTENT_TYPES).forEach(type => {
          const config = CONTENT_TYPES[type];
          const textElement = document.getElementById(config.textField);
          const statusElement = document.getElementById(config.statusField);
          
          if (textElement && textElement.value.trim() !== '') {
            payload[config.textField] = textElement.value;
            payload[config.statusField] = statusElement.value;
          }
        });

        const webhookUrl = "https://hook.eu2.make.com/hw1siz7ad14nfv7tr4y0cte3l2rtkwxm";

        try {
          showLoadingState(true, "review-submit-btn");
          
          const response = await fetch(webhookUrl, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload),
          });

          if (response.ok) {
            showSuccessMessage("Freigaben erfolgreich gespeichert ‚úÖ");
            loadReview(); // NEU: L√∂st sofort eine Aktualisierung der Daten aus
            } else {
              throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
          
        } catch (error) {
          showErrorMessage(`Fehler beim Speichern: ${error.message}`);
        } finally {
          showLoadingState(false, "review-submit-btn");
        }
      }

      // Status Message System
      function showStatusMessage(message, type, persistent = false) {
        const container = document.getElementById("status-container");
        
        if (!persistent) {
          const existing = container.querySelector('.status-message:not(.persistent)');
          if (existing) existing.remove();
        } else {
          const existing = container.querySelector('.status-message');
          if (existing) existing.remove();
        }
        
        const messageDiv = document.createElement('div');
        messageDiv.className = `status-message ${persistent ? 'persistent' : ''}`;
        
        const styles = {
          info: 'background: #dbeafe; color: #1e40af; border: 1px solid #93c5fd;',
          success: 'background: #d1fae5; color: #065f46; border: 1px solid #6ee7b7;',
          error: 'background: #fee2e2; color: #991b1b; border: 1px solid #fca5a5;',
          warning: 'background: #fef3c7; color: #92400e; border: 1px solid #fcd34d;'
        };
        
        messageDiv.setAttribute('style', styles[type] || styles.info);
        messageDiv.textContent = message;
        
        container.appendChild(messageDiv);
        
        if ((type === 'success' || type === 'info') && !persistent) {
          setTimeout(() => {
            messageDiv.style.opacity = '0';
            setTimeout(() => messageDiv.remove(), 300);
          }, 8000);
        }
      }

      function clearPersistentMessage() {
        const container = document.getElementById("status-container");
        const existing = container.querySelector('.status-message.persistent');
        if (existing) existing.remove();
      }

      function showProgressMessage(message) { showStatusMessage(message, 'info'); }
      function showSuccessMessage(message) { showStatusMessage(message, 'success'); }
      function showErrorMessage(message) { showStatusMessage(message, 'error'); }
      function showWarningMessage(message) { showStatusMessage(message, 'warning'); }
      function showInfoMessage(message, persistent = false) { showStatusMessage(message, 'info', persistent); }

      function showLoadingState(isLoading, buttonId = "submit-btn") {
        const button = document.getElementById(buttonId);
        if (button) {
          button.disabled = isLoading;
          if (isLoading) {
            button.innerHTML = '<div class="loading-spinner"></div>Wird verarbeitet...';
          } else {
            button.innerHTML = buttonId === "submit-btn" ? "Inhalt √ºbermitteln" : "Freigaben speichern";
          }
        }
      }
    </script>
  </body>
</html>
